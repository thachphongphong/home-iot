{% extends "layout.html" %}
{% block title %}Home{% endblock %}
{% block content %}
<div class="row">
{% if lights %}
    <div class="col-sm-12 col-md-6 col-xl-4">
        <!-- Interior lights  START -->
        <div class="card" data-unit-group="switch-lights">
            <div class="card-body">
                <h3 class="card-title">Lights</h3>
            </div>
            {% for light in lights %}
            <ul class="list-group list-group-flush">
                <li class="list-group-item d-flex active" data-unit="switch-{{ light['cat'] }}-{{ light['devId'] }}">
                    <svg class="icon-sprite">
                        <use xlink:href="/static/images/icons-sprite.svg#{{ light['icon'] }}"/>
                    </svg>
                    <h5>{{ light['name'] }}</h5>
                    <label class="switch ml-auto checked">
                        <input type="checkbox" id="switch-{{ light['cat'] }}-{{ light['devId'] }}" checked>
                    </label>
                </li>
            </ul>
            {% endfor %}
            <!-- Interior lights  END -->
            <div class="card-body">
                <div class="lights-controls" data-controls="switch-lights">
                    <button data-action="all-on" type="button" class="btn btn-primary lights-control">All <strong>ON</strong></button>
                    <button data-action="all-off" type="button" class="btn btn-secondary lights-control">All <strong>OFF</strong></button>
                </div>
            </div>
        </div>
    </div>
{% endif %}
{% if others %}
    <div class="col-sm-12 col-md-6 col-xl-4">
        <!-- Other START -->
        <div class="card">
            <div class="card-body">
                <h3 class="card-title">Others</h3>
            </div>
        </div>
        {% for other in others %}
        <div class="card" data-unit="switch-{{ other['cat'] }}-{{ other['devId'] }}">
            <div class="card-body d-flex">
                <svg class="icon-sprite">
                    <use xlink:href="/static/images/icons-sprite.svg#{{ other['icon'] }}"/>
                </svg>
                <h5>{{ other['name'] }}</h5>
                <label class="switch ml-auto">
                    <input type="checkbox" id="switch-{{ other['cat'] }}-{{ other['devId'] }}">
                </label>
            </div>
        </div>
        {% endfor %}
        <!-- Other END -->
    </div>
{% endif %}
</div>
{% endblock %}
{% block buttons %}{% endblock %}
{% block js %}
{{js|safe}}
    <!-- jQuery -->
    <script src="/static/js/jquery-3.3.1.min.js"></script>

    <!-- Bootstrap bundle -->
    <script src="/static/js/bootstrap.bundle.min.js"></script>

    <!-- Cross browser support for SVG icon sprites -->
    <script src="/static/js/svg4everybody.min.js"></script>

    <!-- jQuery countdown timer plugin (Exit modal, Garage doors, Washing machine) -->
    <script src="/static/js/iot-timer.min.js"></script>

    <!-- Basic theme functionality (arming, garage doors, switches ...) - using jQuery -->
    <script src="/static/js/iot-functions.min.js"></script>

    <!-- Basic api - using jQuery -->
    <script src="/static/js/iot-api.js"></script>

    <!-- SocketIO bundle - using jQuery -->
    <script src="/static/js/socket.io.min.js"></script>

    <script>
        $(document).ready(function() {
            $('#sidebar,#menu-minifier').toggleClass('mini');
            $('#sidebar,#menu-minifier').hide();
            }); // docready END

            // Apply necessary changes, functionality when content is loaded
            $(window).on('load', function() {

            // This script is necessary for cross browsers icon sprite support (IE9+, ...)
            svg4everybody();

            // "Timeout" function is not neccessary - important is to hide the preloader overlay
            setTimeout(function() {

            // Hide preloader overlay when content is loaded
            $('#iot-preloader,.card-preloader').fadeOut();
            $("#wrapper").removeClass("hidden");

            // Check for Main contents scrollbar visibility and set right position for FAB button
            iot.positionFab();

            }, 800);

            });

            // Apply necessary changes if window resized
            $(window).on('resize', function() {

            // Modal reposition when the window is resized
            $('.modal.centered:visible').each(iot.centerModal);

            // Check for Main contents scrollbar visibility and set right position for FAB button
            iot.positionFab();
            var socket = io.connect('http://' + document.domain + ':' + location.port);

            // Update status from api
            api.getStatus();

            socket.on('mqtt_message', function(data) {
                api.getStatus();
            });

        });
    </script>
{% endblock %}